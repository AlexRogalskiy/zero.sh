addons:
  homebrew:
    update: true
language: swift
os: osx
osx_image: xcode11.3
before_install:
  - cd "$(mktemp -d)"
  - echo "7eb54ed8f2d4db5a7276672146c843f802d138bf9bb7c93df9bec2b949289bca  ./shellcheck.rb" >> formulas.sha256sum
  - echo "9e7362583e49656847013fd8cbe6f9e6e0e19ad0210c3a5bf4c4f728a7104001  ./shfmt.rb" >> formulas.sha256sum
  - echo "df616ab9117478389f88318c9d6a80813ae75c3b2fd22526d19b2b1d2986a77c  ./swiftlint.rb" >> formulas.sha256sum
  - echo "218e1dce3acf313aa52836fc01d90fbb1fa0a9527afe91ad380c7a0cbbf70ed1  ./swiftformat.rb" >> formulas.sha256sum
  - curl --proto "=https" --tlsv1.2 -sSf https://raw.githubusercontent.com/Homebrew/homebrew-core/0eebcf957db82f8945c61e0120d006f7301fbc44/Formula/shellcheck.rb -o shellcheck.rb
  - curl --proto "=https" --tlsv1.2 -sSf https://raw.githubusercontent.com/Homebrew/homebrew-core/a4638648878a81e8ea4cf9aa9d1d2b6388a85271/Formula/shfmt.rb -o shfmt.rb
  - curl --proto "=https" --tlsv1.2 -sSf https://raw.githubusercontent.com/Homebrew/homebrew-core/644ba01953a0a46d1550856e473234798fb08029/Formula/swiftlint.rb -o swiftlint.rb
  - curl --proto "=https" --tlsv1.2 -sSf https://raw.githubusercontent.com/Homebrew/homebrew-core/cb60182c6ce3a4fa916d7e746a1bab2f31b22e5e/Formula/swiftformat.rb -o swiftformat.rb
  - shasum --algorithm 256 --check formulas.sha256sum
  - brew reinstall --force-bottle ./shellcheck.rb
  - brew reinstall --force-bottle ./shfmt.rb
  - brew reinstall --force-bottle ./swiftlint.rb
  - brew reinstall --force-bottle ./swiftformat.rb
  - cd -
script:
  - ./script/lint
  - make
before_deploy:
  - git config --local user.name "Michael Sanders"
  - git config --local user.email "michael.sanders@fastmail.com"
  - ./script/archive --package
deploy:
  provider: releases
  api_key:
    secure: HSQTDi4+GFGvvqKKKapUBlUdt5Gqkbz1G7Eo9f2axWQZsjqRUgvFgOUbEApw4JDsw4yscjNQAOFeirOLnzqp3eHmTV4L+s0rJEvN4kyekE7iXiIjGFH1Qh972kNGyx25xwuWB89ixpKHU+zdMUqEg9x7WwDoZxhyLXu0Ubzv9kzR+Jp0TRIBNNVn6F3KYnqk64FvMVgU4WZR+FWQsC2vJZ6jT/C91y0/DuopIgCqnbzwkl9rZBAwnlbgCslBuNLeOCN0yG6PmITQ2CnrSB89AG038RjoIUwlovDTIH/HzUFEJ/VaEN+LVcCo+ccRQ3kR61PIQnOWe6OtQspRdgsTtPAW7byuX/Y9cjoTNqXoQtjgV64pWRf6rQ+7mZoCKDMt6d1eyJasmAxWGVA6hmcsVU9HeuI32fsYVDshOG99VbOKpK5C/AEoA6jgFL0HEmZzz3BEkZHV451xIybCMbVeWqLwu5o3jI+dd9SYHgmCaCwEESSjeC3PChe6Of/MdeJxLiX4oz4HqFiZHQP9zzeKH8RDTOpGkHQM1EKatOor5hkrhVh/1ZBi4QudUPTrQFwBnjK1MuSmSMRDItFivpNertpQVsmHKLasl2k1KEnlwasffHA2ysMsLrcT+bnLyGSbcK6x6CEALr7Llo5IKhnebPHeaEvBKTQKyPQeqFVbMG0=
  file: ./archive/zero-$TRAVIS_TAG.tar.gz
  skip_cleanup: true
  on:
    master: true
    repo: zero-sh/zero.sh
    tags: true
